<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Preface最近突然发现VMware的服务不守规矩，开机就侯在那了，虽然吧，加一加没占多少内存，但就是看着老不舒服。😶      于是想着能不能让它们动态地在使用VMware时开启，不用时关闭经过一番查询，通过脚本来实现对我来说还是可操作的。（虽然我并不会脚本🙃） Main先是找了些相关教程学习一下。👉 批处理   v_01首先将这些服务的启动类型置为手动，然后：   我的初步想法是：">
<meta property="og:type" content="article">
<meta property="og:title" content="About VMware&#39;s Service">
<meta property="og:url" content="https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/index.html">
<meta property="og:site_name" content="Chy&#39;s blog">
<meta property="og:description" content="Preface最近突然发现VMware的服务不守规矩，开机就侯在那了，虽然吧，加一加没占多少内存，但就是看着老不舒服。😶      于是想着能不能让它们动态地在使用VMware时开启，不用时关闭经过一番查询，通过脚本来实现对我来说还是可操作的。（虽然我并不会脚本🙃） Main先是找了些相关教程学习一下。👉 批处理   v_01首先将这些服务的启动类型置为手动，然后：   我的初步想法是：">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/1.png">
<meta property="article:published_time" content="2020-09-24T03:09:03.000Z">
<meta property="article:modified_time" content="2020-11-18T11:00:14.164Z">
<meta property="article:author" content="chy">
<meta property="article:tag" content="VMware">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/1.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/android-chrome-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>About VMware&#39;s Service</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.1.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives">Writing</a></li>
         
          <li><a href="/categories">Category</a></li>
         
          <li><a href="/search">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/10/31/Dwm-in-Arch/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2020/09/10/Install-arch-Linux-in-VMware/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <!--
<ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&text=About VMware&#39;s Service"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&title=About VMware&#39;s Service"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&is_video=false&description=About VMware&#39;s Service"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=About VMware&#39;s Service&body=Check out this article: https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&title=About VMware&#39;s Service"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&title=About VMware&#39;s Service"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&title=About VMware&#39;s Service"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&title=About VMware&#39;s Service"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&name=About VMware&#39;s Service&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&t=About VMware&#39;s Service"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>
-->

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Preface"><span class="toc-number">1.</span> <span class="toc-text">Preface</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Main"><span class="toc-number">2.</span> <span class="toc-text">Main</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#v-01"><span class="toc-number">2.1.</span> <span class="toc-text">v_01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-02"><span class="toc-number">2.2.</span> <span class="toc-text">v_02</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#END"><span class="toc-number">3.</span> <span class="toc-text">END</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2020%E5%B9%B410%E6%9C%8819%E6%97%A5%E8%BF%9B%E4%B8%80%E6%AD%A5%E5%AE%8C%E5%96%84"><span class="toc-number">4.</span> <span class="toc-text">2020年10月19日进一步完善</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        About VMware&#39;s Service
    </h1>



    <div class="meta">
      <i class="fas fa-user-alt"></i>
      Author:
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">chy</span>
      </span><br>
      
    <div class="postdate">
        <i class="fas fa-calendar-times"></i>
        Date:
      
        <time datetime="2020-09-24T03:09:03.000Z" itemprop="datePublished">2020-09-24</time>
        
        (Updated: <time datetime="2020-11-18T11:00:14.164Z" itemprop="dateModified">2020-11-18</time>)
        
      
    </div>

<br>
      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        Category:
        <a class="category-link" href="/categories/bat/">bat</a><br>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        Tags:
        <a class="tag-link-link" href="/tags/VMware/" rel="tag">VMware</a><br>
    </div>



      <!-- Pageviews added on 2020/9/10 -->
      <i class="fas fa-eye"></i>
      <span id="/2020/09/24/About-VMware-s-Service/" class="leancloud-visitors" data-flag-title="About VMware&#39;s Service">
            <em class="post-meta-item-text">Pageviews:</em>
            <i class="leancloud-visitors-count">loading</i>
      </span>

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>最近突然发现VMware的服务不守规矩，开机就侯在那了，虽然吧，加一加没占多少内存，但就是看着老不舒服。😶  </p>
<img src="/2020/09/24/About-VMware-s-Service/1.png" class="" title="Process information">  
<p>于是想着能不能让它们动态地在使用VMware时开启，不用时关闭<br>经过一番查询，通过脚本来实现对我来说还是可操作的。（虽然我并不会脚本🙃）</p>
<h2 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h2><p>先是找了些相关教程学习一下。👉 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%89%B9%E5%A4%84%E7%90%86">批处理</a>  </p>
<h3 id="v-01"><a href="#v-01" class="headerlink" title="v_01"></a>v_01</h3><p><strong>首先将这些服务的启动类型置为手动</strong>，然后：  </p>
<p>我的初步想法是：</p>
<blockquote>
<p>开机加载该<code>开机脚本</code><br>对进程进行监控，如发现<code>vmware.exe</code>进程（即打开了VMware workstation），则开启对应服务，脚本结束<br>关机前执行<code>关机脚本</code>，关闭这些服务</p>
</blockquote>
<p><strong>开机脚本</strong></p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:: <span class="built_in">start</span> VMware services when VMware Workstation is turned on</span><br><span class="line"></span><br><span class="line">:: Run as administrator</span><br><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">1</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> target=vmware.exe</span><br><span class="line"><span class="built_in">set</span> location_log=C:\Software\VMware\VMwareService_Log.txt</span><br><span class="line"></span><br><span class="line">:Delay</span><br><span class="line">:: <span class="built_in">ping</span> localhost -n <span class="number">10</span></span><br><span class="line">timeout /T <span class="number">10</span></span><br><span class="line"></span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%target%</span>&quot; || <span class="keyword">goto</span> Delay</span><br><span class="line"><span class="keyword">goto</span> TurnOn</span><br><span class="line"></span><br><span class="line">:TurnOn</span><br><span class="line">:: <span class="built_in">echo</span> Onnnnnnnnnnnnnnnnnnnnnnnnnn</span><br><span class="line"><span class="built_in">echo</span> <span class="built_in">start</span> the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure>

<p><strong>关机脚本</strong></p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:: stop VMware services <span class="built_in">at</span> shutdown</span><br><span class="line"></span><br><span class="line">:: Run as administrator</span><br><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">1</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> location_log=C:\Software\VMware\VMwareService_Log.txt</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> stop the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> stop &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMUSBArbService&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure>

<p>然而，在我机子💻上的组策略（百度的方法在家庭版上装的）不知道哪有问题，关机脚本无效…😓，恳请路过大佬解惑🙏<br>开机脚本懒得试，把它丢在了这里 <code>C:\Users\###\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code>  </p>
<h3 id="v-02"><a href="#v-02" class="headerlink" title="v_02"></a>v_02</h3><p>主要是想再多接触一下bat🙃，也是想实现、验证一下脑海中的各种想法是否可行</p>
<blockquote>
<p>上述开机脚本是通过<code>进程监控，服务被触发（VMware.exe出现）开启</code><br>于是想着关机脚本是不是也可以模仿一下？！<br>首先想到的肯定也是<code>进程监控，服务被触发（VMware.exe消失）关闭</code><br>这样的话肯定是要<code>开机脚本</code>和<code>关机脚本</code>交替工作  </p>
<p>就是很不解那组策略😠，必须要实现关机脚本！！！<br>突然想到了 <code>explorer.exe</code>，试一试！！！！</p>
</blockquote>
<p><strong>开机脚本</strong></p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="built_in">start</span> /D &quot;C:\Software\VMware&quot; VMwareServiceOff.bat      👈</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure>

<p><strong>关机脚本</strong></p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:: stop VMware services <span class="built_in">at</span> shutdown</span><br><span class="line"></span><br><span class="line">:: Run as administrator</span><br><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">1</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> target=explorer.exe</span><br><span class="line"><span class="built_in">set</span> location_log=C:\Software\VMware\VMwareService_Log.txt</span><br><span class="line"></span><br><span class="line">:Delay</span><br><span class="line">timeout /T <span class="number">2</span></span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%target%</span>&quot; || <span class="keyword">goto</span> TurnOff</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br><span class="line"></span><br><span class="line">:TurnOff</span><br><span class="line">:: stop VMware services</span><br><span class="line"></span><br><span class="line">:: explorer都关了，log也打不进去了ba</span><br><span class="line">:: <span class="built_in">echo</span> stop the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> stop &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMUSBArbService&quot;</span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure>

<h2 id="END"><a href="#END" class="headerlink" title="END"></a>END</h2><p>其实还是 <code>v_01</code> 吧👇，监控 <code>explorer.exe</code> 的延迟时间不能长，感觉还有点拖慢关机速度。。另外可能还不是百分百命中  </p>
<p><strong>v_01_fin</strong></p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:: <span class="built_in">start</span> VMware services when VMware Workstation is turned on</span><br><span class="line"></span><br><span class="line">:: Run as administrator</span><br><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">1</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> target=vmware.exe</span><br><span class="line"><span class="built_in">set</span> targetS=vmware-hostd.exe</span><br><span class="line"><span class="built_in">set</span> location_log=C:\Software\VMware\VMwareService_Log.txt       👈</span><br><span class="line"></span><br><span class="line">:Delay</span><br><span class="line">:: <span class="built_in">ping</span> localhost -n <span class="number">8</span></span><br><span class="line">timeout /T <span class="number">8</span></span><br><span class="line"></span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%target%</span>&quot; || <span class="keyword">goto</span> TurnOff</span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%targetS%</span>&quot; || <span class="keyword">goto</span> TurnOn</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br><span class="line"></span><br><span class="line">:TurnOn</span><br><span class="line">:: <span class="built_in">echo</span> Onnnnnnnnnnnnnnnnnnnnnnnnnn</span><br><span class="line"><span class="built_in">echo</span> <span class="built_in">start</span> the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br><span class="line"></span><br><span class="line">:TurnOff</span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%targetS%</span>&quot; || <span class="keyword">goto</span> Delay</span><br><span class="line">:: <span class="built_in">echo</span> Offfffffffffffffffffffffff</span><br><span class="line"><span class="built_in">echo</span> stop the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> stop &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMUSBArbService&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br></pre></td></tr></table></figure>

<p>如果可以正确执行，那么<br>如果你需要它开机后台执行，将上述 <code>Run as administrator</code> 代码做如下修改：</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">0</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line">:: <span class="number">1</span> -----&gt; <span class="number">0</span></span><br></pre></td></tr></table></figure>


<h2 id="2020年10月19日进一步完善"><a href="#2020年10月19日进一步完善" class="headerlink" title="2020年10月19日进一步完善"></a>2020年10月19日进一步完善</h2><p>前两天突然发现了VMware中虚拟机的<code>无界面启动</code>方式，命令为：</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;C:\Software\VMware\VMware Workstation\vmrun.exe&quot; <span class="built_in">start</span> &quot;C:\Software\VMware\Virtual Machines\archlinux\archlinux.vmx&quot; nogui</span><br></pre></td></tr></table></figure>

<p>这样，就可以通过<code>ssh</code>来连接虚拟机了。随之而来的问题了，VMware中的相应服务可咋整？！<br>经过观察，又发现一监控项 <code>vmware-vmx.exe</code> ，于是：</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">:: <span class="built_in">start</span> VMware services when VMware Workstation is turned on</span><br><span class="line"></span><br><span class="line">:: Run as administrator</span><br><span class="line">%<span class="number">1</span> <span class="built_in">start</span> &quot;&quot; mshta vbscript:createobject(&quot;shell.application&quot;).shellexecute(&quot;&quot;&quot;%~<span class="number">0</span>&quot;&quot;&quot;,&quot;::&quot;,,&quot;runas&quot;,<span class="number">0</span>)(window.close)&amp;<span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> target=vmware.exe</span><br><span class="line"><span class="built_in">set</span> targetN=vmware-vmx.exe</span><br><span class="line"><span class="built_in">set</span> targetS=vmware-hostd.exe</span><br><span class="line"><span class="built_in">set</span> location_log=C:\Software\VMware\VMwareService_Log.txt</span><br><span class="line"></span><br><span class="line">:Delay</span><br><span class="line">timeout /T <span class="number">6</span></span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%target%</span>&quot; || tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%targetN%</span>&quot; || <span class="keyword">goto</span> TurnOff</span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%targetS%</span>&quot; || <span class="keyword">goto</span> TurnOn</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br><span class="line"></span><br><span class="line">:TurnOn</span><br><span class="line"><span class="built_in">echo</span> <span class="built_in">start</span> the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br><span class="line"></span><br><span class="line">:TurnOff</span><br><span class="line">tasklist | <span class="built_in">find</span> /i &quot;<span class="variable">%targetS%</span>&quot; || <span class="keyword">goto</span> Delay</span><br><span class="line"><span class="built_in">echo</span> stop the services <span class="built_in">at</span> <span class="variable">%date%</span> <span class="variable">%time%</span> &gt;&gt; <span class="variable">%location_log%</span></span><br><span class="line"><span class="built_in">net</span> stop &quot;VMwareHostd&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMUSBArbService&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMnetDHCP&quot;</span><br><span class="line"><span class="built_in">net</span> stop &quot;VMware NAT Service&quot;</span><br><span class="line"><span class="keyword">goto</span> Delay</span><br></pre></td></tr></table></figure>


  </div>
</article>

    <div class="blog-post-comments">
        <div class="vcomment"></div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives">Writing</a></li>
         
          <li><a href="/categories">Category</a></li>
         
          <li><a href="/search">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Preface"><span class="toc-number">1.</span> <span class="toc-text">Preface</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Main"><span class="toc-number">2.</span> <span class="toc-text">Main</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#v-01"><span class="toc-number">2.1.</span> <span class="toc-text">v_01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-02"><span class="toc-number">2.2.</span> <span class="toc-text">v_02</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#END"><span class="toc-number">3.</span> <span class="toc-text">END</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2020%E5%B9%B410%E6%9C%8819%E6%97%A5%E8%BF%9B%E4%B8%80%E6%AD%A5%E5%AE%8C%E5%96%84"><span class="toc-number">4.</span> <span class="toc-text">2020年10月19日进一步完善</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <!--
<ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&text=About VMware&#39;s Service"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&title=About VMware&#39;s Service"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&is_video=false&description=About VMware&#39;s Service"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=About VMware&#39;s Service&body=Check out this article: https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&title=About VMware&#39;s Service"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&title=About VMware&#39;s Service"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&title=About VMware&#39;s Service"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&title=About VMware&#39;s Service"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&name=About VMware&#39;s Service&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://henrycmziz.github.io/2020/09/24/About-VMware-s-Service/&t=About VMware&#39;s Service"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>
-->

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2020-2021
    chy 🙂
    power by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/probberechts/hexo-theme-cactus" target="_blank">cactus</a>
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives">Writing</a></li>
         
          <li><a href="/categories">Category</a></li>
         
          <li><a href="/search">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/iconfont/iconfont.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-179549926-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?909ee0474ecf68883418919a16348363";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>


<!-- Typed, Added on 2020/9/10 -->
<script src="//cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>
<script type="text/javascript">
    
    const option = {
        strings: [  '^1000',
            'Hello~ ^1000',
            ' Stay Hungry, Stay Foolish! :) '],
        typeSpeed: 88,
        startDelay: 2000,
        backSpeed: 22,
        cursorChar: '_'
    };
    const typed = new Typed('.typing', option);
    
</script>

<!-- Valine Comments, added on 2020/9/10 -->

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <script type="text/javascript">
        new Valine({
            el: '.vcomment',
            appId: 'x226vKJ5r3txIO7YW9hAsAUU-MdYXbMMI',
            appKey: 'EyNTMHsVTzdoNb8oo6EfG7cS',
            avatar:"retro",
            placeholder: 'Just say something! :)',
            notify: 'false',
            verify: 'false',
            visitor: 'true',
        });
    </script>


</body>
</html>
